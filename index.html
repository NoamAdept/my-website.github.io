<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gamified Resume - Noam Yakar</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <!-- AOS Animate on Scroll -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- tsParticles -->
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@2/tsparticles.bundle.min.js"></script>
  <!-- Phaser 3 -->
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <style>
    :root {
      --bg-light: #f9fafb;
      --bg-dark: #121212;
      --text-light: #333;
      --text-dark: #eee;
      --accent: #4F46E5;
    }
    html[data-theme='dark'] { background-color: var(--bg-dark); color: var(--text-dark); }
    html[data-theme='light'] { background-color: var(--bg-light); color: var(--text-light); }
    .glass-card { backdrop-filter: blur(10px); background: rgba(255,255,255,0.2); border-radius: 1rem; padding: 1.5rem; box-shadow: 0 4px 30px rgba(0,0,0,0.1); }
    .skill-bar { height: 0.5rem; border-radius: 0.25rem; background: #e5e7eb; overflow: hidden; }
    .skill-bar-fill { height: 100%; width: 0; background: var(--accent); transition: width 1.5s ease-in-out; }
    #game { margin: 0 auto; width: 800px; height: 400px; }
  </style>
</head>
<body class="font-poppins relative overflow-x-hidden">
  <!-- Particle Background -->
  <div id="tsparticles" class="absolute inset-0 -z-10"></div>

  <!-- Navbar & Theme Switcher -->
  <nav class="fixed top-0 w-full bg-white/50 backdrop-blur-md p-4 flex justify-between items-center z-20">
    <h1 class="text-xl font-bold">Noam Yakar</h1>
    <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 hover:bg-gray-300">üåô</button>
  </nav>

  <main class="pt-24 px-6 max-w-4xl mx-auto space-y-16">
    <!-- Other sections omitted for brevity -->

    <!-- Full-Fledged Game Section -->
    <section id="mini-game" class="text-center space-y-4" data-aos="fade-up">
      <h3 class="text-2xl font-semibold mb-2">Skill Runner: Endless Challenge</h3>
      <div id="game"></div>
      <p class="text-lg">Use ‚Üê & ‚Üí to run, ‚Üë to jump, and collect skill tokens!</p>
      <div class="text-xl font-semibold">Score: <span id="game-score">0</span></div>
    </section>
  </main>

  <!-- Scripts -->
  <script>
    // Theme Toggle
    const btn = document.getElementById('theme-toggle');
    btn.addEventListener('click', () => {
      const htmlEl = document.documentElement;
      const current = htmlEl.getAttribute('data-theme');
      const next = current === 'light' ? 'dark' : 'light';
      htmlEl.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      btn.textContent = next === 'light' ? 'üåô' : '‚òÄÔ∏è';
    });
    const saved = localStorage.getItem('theme');
    if (saved) document.documentElement.setAttribute('data-theme', saved);

    // AOS Init
    AOS.init({ once: true, duration: 800 });

    // tsParticles Init
    tsParticles.load('tsparticles', { particles: { number: { value: 80 }, size: { value: 3 }, move: { speed: 1 }, line_linked: { enable: true } } });

    // Skill Bars Animation
    document.querySelectorAll('.skill-bar-fill').forEach(bar => {
      const fill = bar.dataset.fill;
      setTimeout(() => bar.style.width = fill + '%', 500);
    });

    // Chart.js Skill Chart (omitted for brevity)

    // Phaser Game Logic
    const gameConfig = {
      type: Phaser.AUTO, width: 800, height: 400, parent: 'game',
      physics: { default: 'arcade', arcade: { gravity: { y: 600 }, debug: false } },
      scene: { preload, create, update }
    };
    let player, cursors, tokens, scoreText, score = 0, ground;
    function preload() {
      this.load.image('ground', 'https://i.imgur.com/3e5akgy.png');
      this.load.image('token', 'https://img.icons8.com/fluency/48/000000/star.png');
      this.load.spritesheet('dude','https://examples.phaser.io/assets/sprites/dude.png',{ frameWidth:32, frameHeight:48 });
    }
    function create() {
      ground = this.physics.add.staticGroup();
      ground.create(400, 380, 'ground').setScale(2,1).refreshBody();
      player = this.physics.add.sprite(100, 300, 'dude').setBounce(0.2).setCollideWorldBounds(true);
      this.anims.create({ key:'left', frames:this.anims.generateFrameNumbers('dude',{ start:0,end:3 }), frameRate:10, repeat:-1 });
      this.anims.create({ key:'turn',{ frames:[{ key:'dude', frame:4 }], frameRate:20 });
      this.anims.create({ key:'right', frames:this.anims.generateFrameNumbers('dude',{ start:5,end:8 }), frameRate:10, repeat:-1 });
      this.physics.add.collider(player, ground);
      tokens = this.physics.add.group();
      this.physics.add.overlap(player, tokens, collectToken, null, this);
      cursors = this.input.keyboard.createCursorKeys();
      scoreText = this.add.text(16,16,'Score:0',{ fontSize:'20px', fill:'#fff' }).setScrollFactor(0);
      this.time.addEvent({ delay:1000, callback: spawnToken, callbackScope: this, loop: true });
    }
    function update() {
      if (cursors.left.isDown) { player.setVelocityX(-160); player.anims.play('left', true); }
      else if (cursors.right.isDown) { player.setVelocityX(160); player.anims.play('right', true); }
      else { player.setVelocityX(0); player.anims.play('turn'); }
      if (cursors.up.isDown && player.body.touching.down) player.setVelocityY(-330);
      this.cameras.main.startFollow(player);
    }
    function spawnToken() {
      const x = player.x + Phaser.Math.Between(400,800);
      const y = Phaser.Math.Between(100,300);
      const token = tokens.create(x,y,'token');
      token.setVelocityX(-200).setGravityY(-600);
    }
    function collectToken(_player, token) {
      token.disableBody(true,true); score += 10; scoreText.setText('Score:' + score);
      document.getElementById('game-score').textContent = score;
    }
    new Phaser.Game(gameConfig);
  </script>
</body>
</html>
